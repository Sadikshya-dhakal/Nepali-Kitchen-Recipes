{% extends "recipes/base.html" %}
{% load static %}

{% block content %}

<!-- Breadcrumb -->
<section class="bg-white border-b">
    <div class="max-w-7xl mx-auto px-4 py-4">
        <div class="flex items-center gap-2 text-sm text-gray-600">
            <a href="{% url 'home' %}" class="hover:text-orange-500 transition">Home</a>
            <i class="fas fa-chevron-right text-xs"></i>
            <a href="{% url 'all-categories' %}" class="hover:text-orange-500 transition">Categories</a>
            <i class="fas fa-chevron-right text-xs"></i>
            <a href="{% url 'category-detail' recipe.category.pk %}" class="hover:text-orange-500 transition">{{ recipe.category.name }}</a>
            <i class="fas fa-chevron-right text-xs"></i>
            <span class="text-orange-600 font-semibold">{{ recipe.title }}</span>
        </div>
    </div>
</section>

<!-- Recipe Header -->
<section class="max-w-7xl mx-auto px-4 py-8">
    <div class="grid md:grid-cols-2 gap-8">
        <!-- Recipe Image -->
        <div>
            <img src="{{ recipe.featured_image.url|default:'https://images.unsplash.com/photo-1565557623262-b51c2513a641?w=800&q=80' }}"
                alt="{{ recipe.title }}" class="w-full h-96 object-cover rounded-3xl shadow-2xl">

        </div>

        <!-- Recipe Info -->
        <div>
            <!-- Category Badge -->
            <span class="inline-block bg-blue-100 text-blue-600 px-4 py-2 rounded-full text-sm font-semibold mb-4">
                {{ recipe.category.name }}
            </span>

            <!-- Recipe Title -->
            <h1 class="text-4xl md:text-5xl font-bold text-gray-800 mb-4">
                {{ recipe.title }}
            </h1>

            <!-- Recipe Description -->
            <p class="text-gray-600 text-lg mb-6 leading-relaxed">
                {{ recipe.description|default:"A delicious recipe you'll love!" }}
            </p>

            <!-- Rating & Reviews -->
            <div class="flex items-center gap-6 mb-6">
                <div class="flex items-center gap-2">
                    <div class="flex gap-1">
                        {% for star in stars %}
                        {% if recipe.rating|default:0 > forloop.counter0 %}
                        <i class="fas fa-star text-yellow-400"></i>
                        {% else %}
                        <i class="far fa-star text-gray-300"></i>
                        {% endif %}
                        {% endfor %}
                    </div>
                    <span class="font-bold text-gray-800">{{ recipe.rating }}</span>
                    <span class="text-gray-600">({{ recipe.review_count }} reviews)</span>
                </div>
            </div>

            <!-- Recipe Meta Info -->
            <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-8">
                <div class="bg-orange-50 rounded-2xl p-4 text-center">
                    <i class="far fa-clock text-orange-500 text-2xl mb-2"></i>
                    <p class="text-gray-600 text-sm">Prep Time</p>
                    <p class="font-bold text-gray-800">{{ recipe.prep_time }} min</p>
                </div>
                <div class="bg-red-50 rounded-2xl p-4 text-center">
                    <i class="fas fa-fire text-red-500 text-2xl mb-2"></i>
                    <p class="text-gray-600 text-sm">Cook Time</p>
                    <p class="font-bold text-gray-800">{{ recipe.cook_time }} min</p>
                </div>
                <div class="bg-green-50 rounded-2xl p-4 text-center">
                    <i class="fas fa-users text-green-500 text-2xl mb-2"></i>
                    <p class="text-gray-600 text-sm">Servings</p>
                    <p class="font-bold text-gray-800">{{ recipe.servings }} people</p>
                </div>
                <div class="bg-purple-50 rounded-2xl p-4 text-center">
                    <i class="fas fa-signal text-purple-500 text-2xl mb-2"></i>
                    <p class="text-gray-600 text-sm">Difficulty</p>
                    <p class="font-bold text-gray-800">{{ recipe.get_difficulty_display }}</p>
                </div>
            </div>

            <!-- Action Buttons -->
            <div class="flex flex-wrap gap-4">
                <button
                    class="flex-1 bg-orange-500 text-white px-6 py-3 rounded-full font-bold hover:bg-orange-600 transition flex items-center justify-center gap-2">
                    <i class="far fa-heart"></i>
                    Save Recipe
                </button>
                <button
                    class="bg-gray-200 text-gray-700 px-6 py-3 rounded-full font-bold hover:bg-gray-300 transition flex items-center gap-2">
                    <i class="fas fa-print"></i>
                    Print
                </button>
                <button
                    class="bg-gray-200 text-gray-700 px-6 py-3 rounded-full font-bold hover:bg-gray-300 transition flex items-center gap-2">
                    <i class="fas fa-share-alt"></i>
                    Share
                </button>
            </div>
        </div>
    </div>
</section>

<!-- Recipe Content -->
<section class="max-w-7xl mx-auto px-4 py-8">
    <div class="grid md:grid-cols-3 gap-8">
        <!-- Ingredients (Left Sidebar) -->
        <div class="md:col-span-1">
            <div class="bg-white rounded-3xl shadow-lg p-8 sticky top-24">
                <h2 class="text-2xl font-bold text-gray-800 mb-6 flex items-center gap-2">
                    <i class="fas fa-list-ul text-orange-500"></i>
                    Ingredients
                </h2>

                <!-- Servings Adjuster -->
                <div class="bg-orange-50 rounded-2xl p-4 mb-6">
                    <div class="flex items-center justify-between">
                        <span class="font-semibold text-gray-700">Servings:</span>
                        <div class="flex items-center gap-3">
                            <button class="w-8 h-8 bg-white rounded-full shadow hover:bg-gray-100 transition">
                                <i class="fas fa-minus text-sm"></i>
                            </button>
                            <span class="font-bold text-lg">{{ recipe.servings }}</span>
                            <button class="w-8 h-8 bg-white rounded-full shadow hover:bg-gray-100 transition">
                                <i class="fas fa-plus text-sm"></i>
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Ingredients List -->
                <ul class="space-y-3">
                    {% for ingredient in recipe.ingredients_list %}
                    <li class="flex items-start gap-3">
                        <i class="fas fa-check-circle text-orange-500 mt-1"></i>
                        <span class="text-gray-700">{{ ingredient }}</span>
                    </li>
                    {% empty %}
                    <li class="text-gray-500">No ingredients listed yet.</li>
                    {% endfor %}
                </ul>
            </div>
        </div>

        <!-- Instructions (Main Content) -->
        <div class="md:col-span-2">
            <div class="bg-white rounded-3xl shadow-lg p-8">
                <h2 class="text-2xl font-bold text-gray-800 mb-6 flex items-center gap-2">
                    <i class="fas fa-clipboard-list text-orange-500"></i>
                    Instructions
                </h2>

                <!-- Step by Step Instructions -->
                <div class="space-y-6">
                    {% for instruction in recipe.instructions_list %}
                    <div class="flex gap-4">
                        <div
                            class="flex-shrink-0 w-10 h-10 bg-gradient-to-br from-orange-500 to-red-500 text-white rounded-full flex items-center justify-center font-bold">
                            {{ forloop.counter }}
                        </div>
                        <div class="flex-1">
                            <p class="text-gray-700 leading-relaxed">
                                {{ instruction }}
                            </p>
                        </div>
                    </div>
                    {% empty %}
                    <p class="text-gray-500">No instructions provided yet.</p>
                    {% endfor %}
                </div>

                <!-- Chef's Tips -->
                {% if recipe.tips_list %}
                <div class="bg-gradient-to-br from-amber-50 to-orange-50 rounded-2xl p-6 mt-8">
                    <h3 class="font-bold text-lg text-gray-800 mb-3 flex items-center gap-2">
                        <i class="fas fa-lightbulb text-yellow-500"></i>
                        Chef's Tips
                    </h3>
                    <ul class="space-y-2 text-gray-700">
                        {% for tip in recipe.tips_list %}
                        <li class="flex gap-2">
                            <span class="text-orange-500">â€¢</span>
                            <span>{{ tip }}</span>
                        </li>
                        {% endfor %}
                    </ul>
                </div>
                {% endif %}
            </div>
        </div>
    </div>
</section>

<!-- Related Recipes -->
{% if related_recipes %}
<section class="max-w-7xl mx-auto px-4 py-16">
    <h2 class="text-3xl font-bold text-gray-800 mb-8">You May Also Like</h2>
    <div class="grid md:grid-cols-4 gap-6">
        {% for related in related_recipes %}
        <a href="{% url 'recipe-detail' related.pk %}"
            class="bg-white rounded-2xl shadow-lg overflow-hidden hover:shadow-2xl transition transform hover:-translate-y-2">
            {% if related.featured_image %}
            <img src="{{ related.featured_image.url }}" alt="{{ related.title }}" class="w-full h-40 object-cover">
            {% endif %}
            <div class="p-4">
                <h3 class="font-bold text-gray-800 mb-2">{{ related.title }}</h3>
                <div class="flex items-center gap-3 text-sm text-gray-600">
                    <span><i class="far fa-clock mr-1"></i>{{ related.total_time }} min</span>
                    <span><i class="fas fa-star text-yellow-400 mr-1"></i>{{ related.rating }}</span>
                </div>
            </div>
        </a>
        {% endfor %}
    </div>
</section>
{% endif %}


{% endblock content %}